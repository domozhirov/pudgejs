!function(t){function e(t){var e=window.getComputedStyle(t,null).getPropertyValue(i("transform")),o=e.match(/matrix(?:(3d)\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))(?:, (-{0,1}\d+)), -{0,1}\d+\)|\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))\))/);return o?"3d"==o[1]?o.slice(2,5):(o.push(0),o=o.slice(5,8),{x:+o[0],y:+o[1],z:+o[2]}):[0,0,0]}function i(t){var e=document.createElement("div");if(t in e.style)return t;for(var i=["-moz-","-webkit-","-o-","-ms-"],o=0;o<i.length;++o){var s=i[o]+t;if(s in e.style)return s}}function o(t){return t.getBoundingClientRect()}function s(t){var e={x:null,y:null};return t=t.originalEvent||t||window.event,t=t.touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,t.pageX?(e.x=t.pageX,e.y=t.pageY):(e.x=t.clientX,e.y=t.clientY),e}var n="pudgeJS",r=function(e,i){this.opt=t.extend({timing:"ease",duration:.3,button:!1,overlay:n+"-overlay",overlayCss:!0,slideToOpen:!0,slideToClose:!0,wrapper:!1},i),this.$elem=e,this.$win=t(window),this.$doc=t(document),this.$html=t(document.documentElement),this.$body=t(document.body),this.$overlay=t(this.opt.overlay),this.elemWidth=0,this.scrollTop=0,this.isOpened=!1,this.isIOS=/iPhone|iPad|iPod/i.test(navigator.userAgent)&&!window.MSStream,this.isRight=o(this.$elem[0]).left<this.$win.width()/2?-1:1,this.isTouch=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.msPointerEnabled=!("ontouchstart"in document),this.touchEvents={start:this.isTouch?this.msPointerEnabled?"MSPointerDown":"touchstart":"mousedown",move:this.isTouch?this.msPointerEnabled?"MSPointerMove":"touchmove":"mousemove",end:this.isTouch?this.msPointerEnabled?"MSPointerUp":"touchend touchcancel":"mouseup",all:this.isTouch?this.msPointerEnabled?"MSPointerDown MSPointerMove MSPointerUp":"touchstart touchmove touchend touchcancel":"mousedown mousemove mouseup"},this.direction=void 0,this.coord={sx:null,sy:null,mx:null,my:null,lx:null,ly:null,bx:null},this.moveSpeed=[],this._init()};r.prototype={_init:function(){this._onTouchDocument(),this._addOverlay(),this._onSliding()},open:function(){var e=this,i=e.opt.duration,s=e.opt.timing;if(arguments.length)for(var r=arguments.length-1;r>=0;r--)switch(typeof arguments[r]){case"string":i=arguments[r];break;case"number":s=arguments[r]}this.isOpened=!0,this.elemWidth=o(this.$elem[0]).width,animit(this.$overlay[0]).queue({opacity:2,visibility:"visible"},{duration:e.opt.duration,timing:e.opt.timing}).play(),animit(this.$elem[0]).queue({transform:"translate3d(0, 0 ,0)"},{duration:e.opt.duration,timing:e.opt.timing}).play(),this.$html.addClass("overflowHidden userSelect"),this.$elem.addClass(n+"-opened"),this.isIOS&&this.opt.wrapper&&!this.scrollTop&&(this.scrollTop=this.$html.scrollTop()||this.$body.scrollTop(),this.$body.addClass("overflowHidden userSelect"),t(this.opt.wrapper).css("top",-this.scrollTop))},close:function(){var e=this,i=e.opt.duration,s=e.opt.timing;if(arguments.length)for(var r=arguments.length-1;r>=0;r--)switch(typeof arguments[r]){case"string":i=arguments[r];break;case"number":s=arguments[r]}e.isOpened=!1,this.elemWidth=o(this.$elem[0]).width,animit(this.$overlay[0]).queue({opacity:0},{duration:e.opt.duration,timing:e.opt.timing}).play(),animit(this.$elem[0]).queue({transform:"translate3d("+100*e.isRight+"%, 0 ,0)"},{duration:e.opt.duration,timing:e.opt.timing}).play(function(){e.isOpened||(e.$html.removeClass("overflowHidden userSelect"),e.$overlay.css("visibility","hidden")),e.isIOS&&e.opt.wrapper&&setTimeout(t.proxy(function(){e.$body.removeClass("overflowHidden userSelect"),t(this.opt.wrapper).css("top",0),t("html, body").scrollTop(this.scrollTop),this.scrollTop=0},e),100)}),e.$elem.removeClass(n+"-opened")},toggle:function(){return this.isOpened?this.close():this.open()},destroy:function(){this.isOpened=!1,this.$elem.removeAttr("style").removeClass(n+"-opened"),this.$overlay.css({visibility:"hidden",opacity:0}),this.$doc.off(this.touchEvents.start+"."+n),this.$elem.removeData(n)},update:function(e){this.opt=t.extend(this.opt,e)},_onTouchDocument:function(){var e=this,i=!1,o={sx:null,lx:null,sy:null,ly:null};e.$doc.on(this.touchEvents.all,function(n){t(n.target).closest(e.$elem).length||!e.isOpened||t(n.target).closest(e.opt.button).length||(/mousedown|touchstart|MSPointerDown/i.test(n.type)&&(i=!0,o.sx=Math.abs(s(n).x),o.sy=Math.abs(s(n).y)),/mouseup|touchend|MSPointerUp/i.test(n.type)&&i&&(i=!1,o.lx=Math.abs(s(n).x),o.ly=Math.abs(s(n).y),Math.abs(o.lx-o.sx)<5&&Math.abs(o.ly-o.sy)<5&&e.close()))})},_addOverlay:function(){var e;return t("."+this.opt.overlay).length?void(this.$overlay=t("."+this.opt.overlay)):void(this.opt.overlay&&(e=t('<div class="'+this.opt.overlay+'"/>'),e.addClass(this.opt.overlay),this.opt.overlayCss&&e.css({position:"fixed",zIndex:1,left:0,top:0,right:0,bottom:0,opacity:0,visibility:"hidden"}),this.$body.append(e),this.$overlay=e))},_onSliding:function(){function i(i){h.coord.sx=Math.abs(s(i).x),h.coord.sy=Math.abs(s(i).y),h.coord.bx=e(h.$elem[0]).x,h.elemWidth=o(h.$elem[0]).width,h.moveSpeed.push({s:h.coord.mx,t:Date.now()}),t(this).on(h.touchEvents.move+"."+n,r)}function r(t){function e(){var e=h.coord.mx-h.coord.sx;t.preventDefault(),e+=h.coord.bx,e>0&&!(h.isRight+1)?e=0:e<-h.elemWidth&&!(h.isRight+1)?e=-h.elemWidth:0>e&&h.isRight+1?e=0:e>h.elemWidth&&h.isRight+1&&(e=h.elemWidth),h.moveSpeed.push({s:h.coord.mx,t:Date.now()}),h.moveSpeed.length>5&&h.moveSpeed.shift(),h.$html.hasClass("overflowHidden userSelect")||h.$html.addClass("overflowHidden userSelect"),animit(h.$overlay[0]).queue({opacity:(h.elemWidth-Math.abs(e))/h.elemWidth,visibility:"visible",transition:"none",transform:"translateZ(0)"}).play(),animit(h.$elem[0]).queue({transform:"translate3d("+e+"px, 0 ,0)",transition:"none"}).play()}h.coord.mx=Math.abs(s(t).x),h.coord.my=Math.abs(s(t).y),"undefined"==typeof h.direction&&(h.direction=Math.abs(h.coord.mx-h.coord.sx)>Math.abs(h.coord.my-h.coord.sy)?"horizontal":"vertical"),(h.coord.sx<40&&!(h.isRight+1)||h.coord.sx>h.$win.width()-40&&h.isRight+1)&&!h.isIOS&&!h.isOpened&&"horizontal"===h.direction&&h.opt.slideToOpen&&e(),h.isOpened&&"horizontal"===h.direction&&h.opt.slideToClose&&e()}function l(e){var i,l,a,d,c,u;h.coord.lx=Math.abs(s(e).x),h.coord.ly=Math.abs(s(e).y),h.moveSpeed.length>1&&(i=h.moveSpeed.length,a=Math.abs(h.moveSpeed[i-1].s-h.moveSpeed[i-2].s),d=h.moveSpeed[i-1].t-h.moveSpeed[i-2].t,l=a/d,u=h.isRight+1?Math.abs(o(h.$elem[0]).right-h.$win.width()):Math.abs(o(h.$elem[0]).left),h.moveSpeed[i-1].s>h.moveSpeed[i-2].s&&!(h.isRight+1)?c="right":h.moveSpeed[i-1].s<h.moveSpeed[i-2].s&&!(h.isRight+1)?c="left":h.moveSpeed[i-1].s<h.moveSpeed[i-2].s&&h.isRight+1?c="left":h.moveSpeed[i-1].s>h.moveSpeed[i-2].s&&h.isRight+1&&(c="right"),.1>=l&&u<=h.elemWidth/2?h.open("cubic-bezier(0.1, 0.7, 0.1, 1)",.4):.1>=l&&u>h.elemWidth/2?h.close("cubic-bezier(0.1, 0.7, 0.1, 1)",.4):l>.1&&"left"===c&&!(h.isRight+1)?h.close("cubic-bezier(0.1, 0.7, 0.1, 1)",.4):l>.1&&"right"===c&&!(h.isRight+1)?h.open("cubic-bezier(0.1, 0.7, 0.1, 1)",.4):l>.1&&"right"===c&&h.isRight+1?h.close("cubic-bezier(0.1, 0.7, 0.1, 1)",.4):l>.1&&"left"===c&&h.isRight+1&&h.open("cubic-bezier(0.1, 0.7, 0.1, 1)",.4)),t(this).off(h.touchEvents.move+"."+n,r);for(var m in h.coord)h.coord[m]=null;h.moveSpeed=[],h.direction=void 0}var h=this;this.$doc.on(this.touchEvents.start+"."+n,i),this.$doc.on(this.touchEvents.end+"."+n,l)}},t.fn[n]=function(e,i){return this.each(function(){var o,s=t(this);(o=s.data(n))?"string"==typeof e&&o[e]?o[e](i):o.update(e):s.data(n,new r(s,e))})}}(jQuery);