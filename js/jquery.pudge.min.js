!function(t){function e(t){var e=window.getComputedStyle(t,null).getPropertyValue(o("transform")),i=e.match(/matrix(?:(3d)\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))(?:, (-{0,1}\d+)), -{0,1}\d+\)|\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))\))/);return i?"3d"==i[1]?i.slice(2,5):(i.push(0),i=i.slice(5,8),{x:+i[0],y:+i[1],z:+i[2]}):[0,0,0]}function o(t){var e=document.createElement("div");if(t in e.style)return t;for(var o=["-moz-","-webkit-","-o-","-ms-"],i=0;i<o.length;++i){var s=o[i]+t;if(s in e.style)return s}}function i(t){return t.getBoundingClientRect()}function s(t){var e={x:null,y:null};return t=t.originalEvent||t||window.event,t=t.touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,t.pageX?(e.x=t.pageX,e.y=t.pageY):(e.x=t.clientX,e.y=t.clientY),e}var n="pudgeJS",l=function(e,o){this.opt=t.extend({timing:"ease",duration:.3,button:!1,overlay:n+"-overlay",overlayCss:!0,slideToOpen:!0,slideToClose:!0,wrapper:!1},o),this.$elem=e,this.$win=t(window),this.$doc=t(document),this.$html=t(document.documentElement),this.$body=t(document.body),this.$overlay=t(this.opt.overlay),this.elemWidth=0,this.scrollTop=0,this.isOpened=!1,this.isIOS=/iPhone|iPad|iPod/i.test(navigator.userAgent),this.isRight=i(this.$elem[0]).left<this.$win.width()/2?-1:1,this.isTouch=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.msPointerEnabled=window.navigator.msPointerEnabled,this.touchEvents={start:this.isTouch?this.msPointerEnabled?"MSPointerDown":"touchstart":"mousedown",move:this.isTouch?this.msPointerEnabled?"MSPointerMove":"touchmove":"mousemove",end:this.isTouch?this.msPointerEnabled?"MSPointerUp":"touchend touchcancel":"mouseup",all:this.isTouch?this.msPointerEnabled?"MSPointerDown MSPointerMove MSPointerUp":"touchstart touchmove touchend touchcancel":"mousedown mousemove mouseup"},this.direction=void 0,this.coord={sx:null,sy:null,mx:null,my:null,lx:null,ly:null,bx:null},this.moveSpeed=[],this._init()};l.prototype={_init:function(){this._onTouchDocument(),this._addOverlay(),this._onSliding()},open:function(){var e=this,o=e.opt.duration,s=e.opt.timing;if(arguments.length)for(var l=arguments.length-1;l>=0;l--)switch(typeof arguments[l]){case"string":o=arguments[l];break;case"number":s=arguments[l]}this.isOpened=!0,this.elemWidth=i(this.$elem[0]).width,animit(this.$overlay[0]).queue({opacity:2,visibility:"visible"},{duration:e.opt.duration,timing:e.opt.timing}).play(),animit(this.$elem[0]).queue({transform:"translate3d(0, 0 ,0)"},{duration:e.opt.duration,timing:e.opt.timing}).play(),this.$html.addClass("overflowHidden userSelect"),this.$elem.addClass(n+"-opened"),this.isIOS&&this.opt.wrapper&&!this.scrollTop&&(this.scrollTop=this.$html.scrollTop()||this.$body.scrollTop(),this.$body.addClass("overflowHidden userSelect"),t(this.opt.wrapper).css("top",-this.scrollTop))},close:function(){var e=this;e.isOpened=!1,this.elemWidth=i(this.$elem[0]).width,animit(this.$overlay[0]).queue({opacity:0},{duration:e.opt.duration,timing:e.opt.timing}).play(),animit(this.$elem[0]).queue({transform:"translate3d("+100*e.isRight+"%, 0 ,0)"},{duration:e.opt.duration,timing:e.opt.timing}).play(function(){e.isOpened||(e.$html.removeClass("overflowHidden userSelect"),e.$overlay.css("visibility","hidden")),e.isIOS&&e.opt.wrapper&&setTimeout(t.proxy(function(){e.$body.removeClass("overflowHidden userSelect"),t(this.opt.wrapper).css("top",0),t("html, body").scrollTop(this.scrollTop),this.scrollTop=0},e),100)}),e.$elem.removeClass(n+"-opened")},toggle:function(){return this.isOpened?this.close():this.open()},destroy:function(){this.isOpened=!1,this.$elem.removeAttr("style").removeClass(n+"-opened"),this.$overlay.css({visibility:"hidden",opacity:0}),this.$doc.off(this.touchEvents.start+"."+n),this.$elem.removeData(n)},update:function(e){this.opt=t.extend(this.opt,e)},_onTouchDocument:function(){var e=this,o=!1,i={sx:null,lx:null,sy:null,ly:null};e.$doc.on(this.touchEvents.all,function(n){t(n.target).closest(e.$elem).length||!e.isOpened||t(n.target).closest(e.opt.button).length||(/mousedown|touchstart|MSPointerDown/i.test(n.type)&&(o=!0,i.sx=Math.abs(s(n).x),i.sy=Math.abs(s(n).y)),/mouseup|touchend|MSPointerUp/i.test(n.type)&&o&&(o=!1,i.lx=Math.abs(s(n).x),i.ly=Math.abs(s(n).y),Math.abs(i.lx-i.sx)<5&&Math.abs(i.ly-i.sy)<5&&e.close()))})},_addOverlay:function(){var e;return t("."+this.opt.overlay).length?void(this.$overlay=t("."+this.opt.overlay)):void(this.opt.overlay&&(e=t('<div class="'+this.opt.overlay+'"/>'),e.addClass(this.opt.overlay),this.opt.overlayCss&&e.css({position:"fixed",zIndex:1,left:0,top:0,right:0,bottom:0,opacity:0,visibility:"hidden"}),this.$body.append(e),this.$overlay=e))},_onSliding:function(){function o(o){a.coord.sx=Math.abs(s(o).x),a.coord.sy=Math.abs(s(o).y),a.coord.bx=e(a.$elem[0]).x,a.elemWidth=i(a.$elem[0]).width,a.moveSpeed.push({s:a.coord.mx,t:Date.now()}),t(this).on(a.touchEvents.move+"."+n,l)}function l(t){function e(){var e=a.coord.mx-a.coord.sx;t.preventDefault(),e+=a.coord.bx,e>0&&!(a.isRight+1)?e=0:e<-a.elemWidth&&!(a.isRight+1)?e=-a.elemWidth:0>e&&a.isRight+1?e=0:e>a.elemWidth&&a.isRight+1&&(e=a.elemWidth),a.moveSpeed.push({s:a.coord.mx,t:Date.now()}),a.moveSpeed.length>5&&a.moveSpeed.shift(),a.$html.hasClass("overflowHidden userSelect")||a.$html.addClass("overflowHidden userSelect"),animit(a.$overlay[0]).queue({opacity:(a.elemWidth-Math.abs(e))/a.elemWidth,visibility:"visible",transition:"none",transform:"translateZ(0)"}).play(),animit(a.$elem[0]).queue({transform:"translate3d("+e+"px, 0 ,0)",transition:"none"}).play()}a.coord.mx=Math.abs(s(t).x),a.coord.my=Math.abs(s(t).y),"undefined"==typeof a.direction&&(a.direction=Math.abs(a.coord.mx-a.coord.sx)>Math.abs(a.coord.my-a.coord.sy)?"horizontal":"vertical"),(a.coord.sx<40&&!(a.isRight+1)||a.coord.sx>a.$win.width()-40&&a.isRight+1)&&!a.isIOS&&!a.isOpened&&"horizontal"===a.direction&&a.opt.slideToOpen&&e(),a.isOpened&&"horizontal"===a.direction&&a.opt.slideToClose&&e()}function h(e){var o,h,r,d,u,c;a.coord.lx=Math.abs(s(e).x),a.coord.ly=Math.abs(s(e).y),a.moveSpeed.length>1&&(o=a.moveSpeed.length,r=Math.abs(a.moveSpeed[o-1].s-a.moveSpeed[o-2].s),d=a.moveSpeed[o-1].t-a.moveSpeed[o-2].t,h=r/d,c=Math.abs(a.isRight+1?i(a.$elem[0]).right-a.$win.width():i(a.$elem[0]).left),a.moveSpeed[o-1].s>a.moveSpeed[o-2].s&&!(a.isRight+1)?u="right":a.moveSpeed[o-1].s<a.moveSpeed[o-2].s&&!(a.isRight+1)?u="left":a.moveSpeed[o-1].s<a.moveSpeed[o-2].s&&a.isRight+1?u="left":a.moveSpeed[o-1].s>a.moveSpeed[o-2].s&&a.isRight+1&&(u="right"),.1>=h&&c<a.elemWidth/2?a.open("ease-out"):.1>=h&&c>a.elemWidth/2?a.close("ease-out"):h>.1&&"left"===u&&!(a.isRight+1)?a.close("ease-out"):h>.1&&"right"===u&&!(a.isRight+1)?a.open("ease-out"):h>.1&&"right"===u&&a.isRight+1?a.close("ease-out"):h>.1&&"left"===u&&a.isRight+1&&a.open("ease-out")),t(this).off(a.touchEvents.move+"."+n,l);for(var m in a.coord)a.coord[m]=null;a.moveSpeed=[],a.direction=void 0}var a=this;this.$doc.on(this.touchEvents.start+"."+n,o),this.$doc.on(this.touchEvents.end+"."+n,h)}},t.fn[n]=function(e,o){return this.each(function(){var i,s=t(this);(i=s.data(n))?"string"==typeof e&&i[e]?i[e](o):i.update(e):s.data(n,new l(s,e))})}}(jQuery);